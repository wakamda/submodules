# socket编程原理

## 基本概念

#### 1. 进程间通信

1. 端口：**端口是一种抽象的软件结构（包括一些数据结构和 I/O 缓冲区）。** 应用程序（即进程）通过系统调用与某端口建立连接（ binding）后，传输层传给该端口的数据都被相应进程所接收，相应进程发给传输层的数据都通过该端口输出。在 TCP/IP 协议的实现中，端口操作类似于一般的 I/O 操作，进程获取一个端口，相当于获取本地唯一的 I/O 文件，可以用一般的读写原语访问之。

2. 端口号：类似于文件描述符，每个端口都拥有一个叫端口号（ port number）的整数型标识符，用于区别不同端口。由于 TCP/IP 传输层的两个协议 TCP 和 UDP 是完全独立的两个软件模块，因此各自的端口号也相互独立，如 TCP 有一个 255 号端口， UDP 也可以有一个 255 号端口，二者并不冲突。

3. 地址

4. 网络字节顺序

5. 连接

6. 半相关（三元组：协议，本地地址，本地端口号）

7. 全相关：一个完整的网间进程通信需要由两个进程组成，并且只能使用同一种高层协议。也就是说，不可能通信的一端用 TCP 协议，而另一端用 UDP 协议。因此**一个完整的网间通信需要一个五元组来标识：（协议，本地地址，本地端口号，远地地址，远地端口号）**这样一个五元组，叫做一个相关（ association）， 即两个协议相同的半相关才能组合成一个合适的相关，或完全指定组成一连接。



#### 2. 服务方式

1. 面向连接服务是电话系统服务模式的抽象，即每一次完整的数据传输都要经过建立连接，使用连接，终止连接的过程。在数据传输过程中，各数据分组不携带目的地址，而使用连接号（ connect ID）。本质上，连接是一个管道，收发数据不但顺序一致，而且内容相同。 TCP 协议提供面向连接的虚电路。

2. 无连接服务是邮政系统服务的抽象，每个分组都携带完整的目的地址，各分组在系统中独立传送。无连接服务不能保证分组的先后顺序，不进行分组出错的恢复与重传，不保证传输的可靠性。 UDP 协议提供无连接的数据报服务.

   关于TCP/UDP另说

   

#### 3. 套接字类型  

1. 流式套接字（SOCK_STREAM）
   提供了一个面向连接、可靠的数据传输服务，数据无差错、无重复地发送，且按发送顺序接收。内设流量控制，避免数据流超限；数据被看作是字节流，无长度限制。文件传送协议（ FTP）即使用流式套接字。  
2. 数据报式套接字（SOCK_DGRAM）
   提供了一个无连接服务。数据包以独立包形式被发送，不提供无错保证，数据可能丢失或重复，并且接收顺序混乱。网络文件系统（ NFS）使用数据报式套接字。  
3. 原始式套接字（SOCK_RAW）
   该接口允许对较低层协议，如 IP、 ICMP 直接访问。常用于检验新的协议实现或访问现有服务中配置的新设备。



## 基本套接字系统调用  



## 典型套接字调用过程举例

